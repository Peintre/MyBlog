import{p as B}from"./common.10683f1a.js";import{ag as o,aj as M,o as s,Q as p,R as i,a as _,W as m,X as l,c as f,a6 as y,F as b,a7 as Y,V as a,S as A,U as w}from"./@vue.9e9a2d45.js";import{_ as K}from"./index.ae6b5db7.js";import"./dayjs.68f6f475.js";import"./@babel.1ce85722.js";import"./axios.cdba3bd7.js";import"./form-data.d1f94bc2.js";import"./vue-router.b11bef48.js";import"./vuex.029ab250.js";import"./vuex-persistedstate.fa252374.js";import"./nprogress.8c2c2e00.js";import"./vue-axios.516efde1.js";import"./element-plus.e856da41.js";import"./lodash-es.1d9717e1.js";import"./@vueuse.15af719d.js";import"./@element-plus.b2728cca.js";import"./@popperjs.36402333.js";import"./@ctrl.82a509e0.js";import"./async-validator.fb49d0f5.js";import"./memoize-one.4ee5c96d.js";import"./escape-html.e5dfadb9.js";import"./normalize-wheel-es.8aeb3683.js";import"./@floating-ui.f14f28ca.js";import"./@kangc.b9a0ef8b.js";import"./vue.a84c3055.js";import"./markdown-it-emoji.952032df.js";import"./@vuepress.3e7afe62.js";import"./markdown-it-container.512a5043.js";import"./highlight.js.6e93349b.js";import"./codemirror.59d98cc1.js";const j={created(){this.listUsers(),this.listRoles()},computed:{dataFormat(){return function(e){return B(e,"YYYY-MM-DD")}}},data:function(){return{loading:!0,isEdit:!1,userForm:{userInfoId:null,nickname:""},dialogTitle:"",loginType:null,userRoleList:[],roleIdList:[],userList:[],typeList:[{type:1,desc:"\u90AE\u7BB1"},{type:2,desc:"QQ"},{type:3,desc:"\u5FAE\u535A"}],keywords:null,current:1,size:10,count:0}},methods:{searchUsers(){this.current=1,this.listUsers()},sizeChange(e){this.size=e,this.listUsers()},currentChange(e){this.current=e,this.listUsers()},changeDisable(e){this.axios.put("/api/admin/users/disable",{id:e.userInfoId,isDisable:e.isDisable})},openEditModel(e){this.roleIdList=[],this.userForm=JSON.parse(JSON.stringify(e)),this.userForm.roleList.forEach(r=>{this.roleIdList.push(r.id)}),this.isEdit=!0},editUserRole(){this.userForm.roleIdList=this.roleIdList,this.axios.put("/api/userInfo/updateUserRole",this.userForm).then(({data:e})=>{e.flag?(this.$notify.success({title:"\u6210\u529F",message:e.message}),this.listUsers()):this.$notify.error({title:"\u5931\u8D25",message:e.message}),this.isEdit=!1})},listUsers(){this.axios.get("/api/userAuth/getUserList",{params:{current:this.current,size:this.size,keywords:this.keywords,loginType:this.loginType}}).then(({data:e})=>{this.userList=e.data.recordList,this.count=e.data.count,this.loading=!1})},listRoles(){this.axios.get("/api/role/getUserRoles").then(({data:e})=>{this.userRoleList=e.data})}},watch:{loginType(){this.current=1,this.listUsers()}}},x={class:"title"},J={class:"operation-container"},O={style:{"margin-left":"auto"}},W=["src"];function X(e,r,$,q,G,d){const L=o("el-option"),C=o("el-select"),k=o("Search"),c=o("el-icon"),v=o("el-input"),g=o("el-button"),n=o("el-table-column"),h=o("el-tag"),T=o("el-switch"),U=o("Timer"),z=o("el-table"),F=o("el-pagination"),V=o("el-form-item"),D=o("el-checkbox"),I=o("el-checkbox-group"),E=o("el-form"),R=o("el-dialog"),S=o("el-card"),N=M("loading");return s(),p(S,{class:"main-card"},{default:i(()=>[_("div",x,m(this.$route.name),1),_("div",J,[_("div",O,[l(C,{clearable:"",modelValue:e.loginType,"onUpdate:modelValue":r[0]||(r[0]=t=>e.loginType=t),placeholder:"\u8BF7\u9009\u62E9\u767B\u5F55\u65B9\u5F0F",size:"small",style:{"margin-right":"1rem"}},{default:i(()=>[(s(!0),f(b,null,y(e.typeList,t=>(s(),p(L,{key:t.type,label:t.desc,value:t.type},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),l(v,{modelValue:e.keywords,"onUpdate:modelValue":r[1]||(r[1]=t=>e.keywords=t),size:"small",placeholder:"\u8BF7\u8F93\u5165\u6635\u79F0",style:{width:"200px"},onKeyup:Y(d.searchUsers,["enter","native"])},{prefix:i(()=>[l(c,null,{default:i(()=>[l(k)]),_:1})]),_:1},8,["modelValue","onKeyup"]),l(g,{type:"primary",size:"small",style:{"margin-left":"1rem"},onClick:d.searchUsers},{default:i(()=>[l(c,null,{default:i(()=>[l(k)]),_:1}),a(" \u641C\u7D22 ")]),_:1},8,["onClick"])])]),A((s(),p(z,{border:"",data:e.userList},{default:i(()=>[l(n,{prop:"linkAvatar",label:"\u5934\u50CF",align:"center",width:"100"},{default:i(t=>[_("img",{src:t.row.avatar,width:"40",height:"40"},null,8,W)]),_:1}),l(n,{prop:"nickname",label:"\u6635\u79F0",align:"center",width:"140"}),l(n,{prop:"loginType",label:"\u767B\u5F55\u65B9\u5F0F",align:"center",width:"80"},{default:i(t=>[t.row.loginType==1?(s(),p(h,{key:0,type:"success"},{default:i(()=>[a("\u90AE\u7BB1")]),_:1})):w("",!0),t.row.loginType==2?(s(),p(h,{key:1},{default:i(()=>[a("QQ")]),_:1})):w("",!0),t.row.loginType==3?(s(),p(h,{key:2,type:"danger"},{default:i(()=>[a("\u5FAE\u535A")]),_:1})):w("",!0)]),_:1}),l(n,{prop:"roleList",label:"\u7528\u6237\u89D2\u8272",align:"center"},{default:i(t=>[(s(!0),f(b,null,y(t.row.roleList,(u,Q)=>(s(),p(h,{key:Q,style:{"margin-right":"4px","margin-top":"4px"}},{default:i(()=>[a(m(u.roleName),1)]),_:2},1024))),128))]),_:1}),l(n,{prop:"isDisable",label:"\u7981\u7528",align:"center",width:"100"},{default:i(t=>[l(T,{modelValue:t.row.isDisable,"onUpdate:modelValue":u=>t.row.isDisable=u,"active-color":"#13ce66","inactive-color":"#F4F4F5","active-value":1,"inactive-value":0,onChange:u=>d.changeDisable(t.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),l(n,{prop:"ipAddress",label:"\u767B\u5F55ip",align:"center",width:"140"}),l(n,{prop:"ipSource",label:"\u767B\u5F55\u5730\u5740",align:"center",width:"140"}),l(n,{prop:"createTime",label:"\u521B\u5EFA\u65F6\u95F4",width:"130",align:"center"},{default:i(t=>[l(c,{style:{"margin-right":"5px"}},{default:i(()=>[l(U)]),_:1}),a(" "+m(d.dataFormat(t.row.createTime)),1)]),_:1}),l(n,{prop:"lastLoginTime",label:"\u4E0A\u6B21\u767B\u5F55\u65F6\u95F4",width:"130",align:"center"},{default:i(t=>[l(c,{style:{"margin-right":"5px"}},{default:i(()=>[l(U)]),_:1}),a(" "+m(d.dataFormat(t.row.lastLoginTime)),1)]),_:1}),l(n,{label:"\u64CD\u4F5C",align:"center",width:"100"},{default:i(t=>[l(g,{type:"primary",size:"small",onClick:u=>d.openEditModel(t.row)},{default:i(()=>[a(" \u7F16\u8F91 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[N,e.loading]]),l(F,{class:"pagination-container",background:"",onSizeChange:d.sizeChange,onCurrentChange:d.currentChange,"current-page":e.current,"page-size":e.size,total:e.count,"page-sizes":[10,20],layout:"total, sizes, prev, pager, next, jumper"},null,8,["onSizeChange","onCurrentChange","current-page","page-size","total"]),l(R,{modelValue:e.isEdit,"onUpdate:modelValue":r[5]||(r[5]=t=>e.isEdit=t),width:"30%",title:e.dialogTitle},{footer:i(()=>[l(g,{onClick:r[4]||(r[4]=t=>e.isEdit=!1)},{default:i(()=>[a("\u53D6 \u6D88")]),_:1}),l(g,{type:"primary",onClick:d.editUserRole},{default:i(()=>[a(" \u786E \u5B9A ")]),_:1},8,["onClick"])]),default:i(()=>[l(E,{"label-width":"60px",size:"small",model:e.userForm},{default:i(()=>[l(V,{label:"\u6635\u79F0"},{default:i(()=>[l(v,{modelValue:e.userForm.nickname,"onUpdate:modelValue":r[2]||(r[2]=t=>e.userForm.nickname=t),style:{width:"220px"}},null,8,["modelValue"])]),_:1}),l(V,{label:"\u89D2\u8272"},{default:i(()=>[l(I,{modelValue:e.roleIdList,"onUpdate:modelValue":r[3]||(r[3]=t=>e.roleIdList=t)},{default:i(()=>[(s(!0),f(b,null,y(e.userRoleList,t=>(s(),p(D,{key:t.id,label:t.id},{default:i(()=>[a(m(t.roleName),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])]),_:1})}var Te=K(j,[["render",X]]);export{Te as default};
