import{p as F}from"./common.10683f1a.js";import{ag as s,aj as M,o,Q as d,R as i,a as r,W as f,L as w,X as n,V as a,c as v,a6 as Y,F as K,a7 as U,S as j,U as _,b7 as E,b6 as H}from"./@vue.9e9a2d45.js";import{_ as Q}from"./index.ae6b5db7.js";import"./dayjs.68f6f475.js";import"./@babel.1ce85722.js";import"./axios.cdba3bd7.js";import"./form-data.d1f94bc2.js";import"./vue-router.b11bef48.js";import"./vuex.029ab250.js";import"./vuex-persistedstate.fa252374.js";import"./nprogress.8c2c2e00.js";import"./vue-axios.516efde1.js";import"./element-plus.e856da41.js";import"./lodash-es.1d9717e1.js";import"./@vueuse.15af719d.js";import"./@element-plus.b2728cca.js";import"./@popperjs.36402333.js";import"./@ctrl.82a509e0.js";import"./async-validator.fb49d0f5.js";import"./memoize-one.4ee5c96d.js";import"./escape-html.e5dfadb9.js";import"./normalize-wheel-es.8aeb3683.js";import"./@floating-ui.f14f28ca.js";import"./@kangc.b9a0ef8b.js";import"./vue.a84c3055.js";import"./markdown-it-emoji.952032df.js";import"./@vuepress.3e7afe62.js";import"./markdown-it-container.512a5043.js";import"./highlight.js.6e93349b.js";import"./codemirror.59d98cc1.js";const W={created(){this.listComments()},data:function(){return{loading:!0,remove:!1,options:[{value:1,label:"\u6587\u7AE0"},{value:2,label:"\u53CB\u94FE"},{value:3,label:"\u8BF4\u8BF4"}],commentList:[],commentIdList:[],type:null,keywords:null,isReview:null,current:1,size:10,count:0}},computed:{dataFormat(){return function(e){return F(e,"YYYY-MM-DD")}}},methods:{selectionChange(e){this.commentIdList=[],e.forEach(l=>{this.commentIdList.push(l.id)})},searchComments(){this.current=1,this.listComments()},sizeChange(e){this.size=e,this.listComments()},currentChange(e){this.current=e,this.listComments()},changeReview(e){this.current=1,this.isReview=e},updateCommentReview(e){let l={};e!=null?l.idList=[e]:l.idList=this.commentIdList,l.isReview=1,this.axios.put("/api/admin/comments/review",l).then(({data:p})=>{p.flag?(this.$notify.success({title:"\u6210\u529F",message:p.message}),this.listComments()):this.$notify.error({title:"\u5931\u8D25",message:p.message})})},deleteComments(e){var l={};e==null?l={data:this.commentIdList}:l={data:[e]},this.axios.delete("/api/admin/comments",l).then(({data:p})=>{p.flag?(this.$notify.success({title:"\u6210\u529F",message:p.message}),this.listComments()):this.$notify.error({title:"\u5931\u8D25",message:p.message}),this.remove=!1})},listComments(){this.axios.get("/api/comment/getComments",{params:{current:this.current,size:this.size,keywords:this.keywords,type:this.type,isReview:this.isReview}}).then(({data:e})=>{this.commentList=e.data.recordList,this.count=e.data.count,this.loading=!1})}},watch:{isReview(){this.current=1,this.listComments()},type(){this.current=1,this.listComments()}}},y=e=>(E("data-v-0a27fcf3"),e=e(),H(),e),X={class:"title"},q={class:"review-menu"},A=y(()=>r("span",null,"\u72B6\u6001",-1)),G={class:"operation-container"},J={style:{"margin-left":"auto"}},O=["src"],P={key:0},Z={key:1},x={key:0},ee={key:1},te=["innerHTML"],ie=y(()=>r("div",{class:"dialog-title-container",slot:"title"},[r("i",{class:"el-icon-warning",style:{color:"#ff9900"}}),a("\u63D0\u793A ")],-1)),ne=y(()=>r("div",{style:{"font-size":"1rem"}},"\u662F\u5426\u5F7B\u5E95\u5220\u9664\u9009\u4E2D\u9879\uFF1F",-1)),le={slot:"footer"};function se(e,l,p,oe,ae,m){const k=s("Delete"),h=s("el-icon"),u=s("el-button"),b=s("CircleCheck"),z=s("el-option"),R=s("el-select"),C=s("Search"),L=s("el-input"),c=s("el-table-column"),S=s("Timer"),g=s("el-tag"),I=s("el-popconfirm"),V=s("el-table"),T=s("el-pagination"),D=s("el-dialog"),N=s("el-card"),$=M("loading");return o(),d(N,{class:"main-card"},{default:i(()=>[r("div",X,f(this.$route.name),1),r("div",q,[A,r("span",{onClick:l[0]||(l[0]=t=>m.changeReview(null)),class:w(e.isReview==null?"active-review":"review")}," \u5168\u90E8 ",2),r("span",{onClick:l[1]||(l[1]=t=>m.changeReview(1)),class:w(e.isReview==1?"active-review":"review")}," \u6B63\u5E38 ",2),r("span",{onClick:l[2]||(l[2]=t=>m.changeReview(0)),class:w(e.isReview==0?"active-review":"review")}," \u5BA1\u6838\u4E2D ",2)]),r("div",G,[n(u,{type:"danger",size:"small",disabled:e.commentIdList.length==0,onClick:l[3]||(l[3]=t=>e.remove=!0)},{default:i(()=>[n(h,null,{default:i(()=>[n(k)]),_:1}),a(" \u6279\u91CF\u5220\u9664 ")]),_:1},8,["disabled"]),n(u,{type:"success",size:"small",disabled:e.commentIdList.length==0,onClick:l[4]||(l[4]=t=>m.updateCommentReview(null))},{default:i(()=>[n(h,null,{default:i(()=>[n(b)]),_:1}),a(" \u6279\u91CF\u901A\u8FC7 ")]),_:1},8,["disabled"]),r("div",J,[n(R,{clearable:"",modelValue:e.type,"onUpdate:modelValue":l[5]||(l[5]=t=>e.type=t),placeholder:"\u8BF7\u9009\u62E9\u6765\u6E90",size:"small",style:{"margin-right":"1rem"}},{default:i(()=>[(o(!0),v(K,null,Y(e.options,t=>(o(),d(z,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),n(L,{modelValue:e.keywords,"onUpdate:modelValue":l[6]||(l[6]=t=>e.keywords=t),size:"small",placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u6635\u79F0",style:{width:"200px"},onKeyup:U(m.searchComments,["enter","native"])},{prefix:i(()=>[n(h,null,{default:i(()=>[n(C)]),_:1})]),_:1},8,["modelValue","onKeyup"]),n(u,{type:"primary",size:"small",style:{"margin-left":"1rem"},onClick:m.searchComments},{default:i(()=>[n(h,null,{default:i(()=>[n(C)]),_:1}),a("\u641C\u7D22 ")]),_:1},8,["onClick"])])]),j((o(),d(V,{border:"",data:e.commentList,onSelectionChange:m.selectionChange},{default:i(()=>[n(c,{type:"selection",width:"55"}),n(c,{prop:"avatar",label:"\u5934\u50CF",align:"center",width:"120"},{default:i(t=>[r("img",{src:t.row.avatar,width:"40",height:"40"},null,8,O)]),_:1}),n(c,{prop:"nickname",label:"\u8BC4\u8BBA\u4EBA",align:"center",width:"120"}),n(c,{prop:"replyNickname",label:"\u56DE\u590D\u4EBA",align:"center",width:"120"},{default:i(t=>[t.row.replyNickname?(o(),v("span",P,f(t.row.replyNickname),1)):(o(),v("span",Z,"\u65E0"))]),_:1}),n(c,{prop:"articleTitle",label:"\u6587\u7AE0\u6807\u9898",align:"center"},{default:i(t=>[t.row.articleTitle?(o(),v("span",x,f(t.row.articleTitle),1)):(o(),v("span",ee,"\u65E0"))]),_:1}),n(c,{prop:"commentContent",label:"\u8BC4\u8BBA\u5185\u5BB9",align:"center"},{default:i(t=>[r("span",{innerHTML:t.row.commentContent,class:"comment-content"},null,8,te)]),_:1}),n(c,{prop:"createTime",label:"\u8BC4\u8BBA\u65F6\u95F4",width:"150",align:"center"},{default:i(t=>[n(h,{style:{"margin-right":"5px"}},{default:i(()=>[n(S)]),_:1}),a(" "+f(m.dataFormat(t.row.createTime)),1)]),_:1}),n(c,{prop:"isReview",label:"\u72B6\u6001",width:"80",align:"center"},{default:i(t=>[t.row.isReview==0?(o(),d(g,{key:0,type:"warning"},{default:i(()=>[a("\u5BA1\u6838\u4E2D")]),_:1})):_("",!0),t.row.isReview==1?(o(),d(g,{key:1,type:"success"},{default:i(()=>[a("\u6B63\u5E38")]),_:1})):_("",!0)]),_:1}),n(c,{label:"\u6765\u6E90",align:"center",width:"100"},{default:i(t=>[t.row.type==1?(o(),d(g,{key:0},{default:i(()=>[a("\u6587\u7AE0")]),_:1})):_("",!0),t.row.type==2?(o(),d(g,{key:1,type:"warning"},{default:i(()=>[a("\u53CB\u94FE")]),_:1})):_("",!0),t.row.type==3?(o(),d(g,{key:2,type:"danger"},{default:i(()=>[a("\u8BF4\u8BF4")]),_:1})):_("",!0)]),_:1}),n(c,{label:"\u64CD\u4F5C",width:"160",align:"center"},{default:i(t=>[t.row.isReview==0?(o(),d(u,{key:0,size:"mini",type:"success",slot:"reference",onClick:B=>m.updateCommentReview(t.row.id)},{default:i(()=>[a(" \u901A\u8FC7 ")]),_:2},1032,["onClick"])):_("",!0),n(I,{style:{"margin-left":"10px"},title:"\u786E\u5B9A\u5220\u9664\u5417\uFF1F",onConfirm:B=>m.deleteComments(t.row.id)},{reference:i(()=>[n(u,{size:"small",type:"danger",slot:"reference"},{default:i(()=>[a(" \u5220\u9664 ")]),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data","onSelectionChange"])),[[$,e.loading]]),n(T,{class:"pagination-container",background:"",onSizeChange:m.sizeChange,onCurrentChange:m.currentChange,"current-page":e.current,"page-size":e.size,total:e.count,"page-sizes":[10,20],layout:"total, sizes, prev, pager, next, jumper"},null,8,["onSizeChange","onCurrentChange","current-page","page-size","total"]),n(D,{visible:e.remove,width:"30%"},{default:i(()=>[ie,ne,r("div",le,[n(u,{onClick:l[7]||(l[7]=t=>e.remove=!1)},{default:i(()=>[a("\u53D6 \u6D88")]),_:1}),n(u,{type:"primary",onClick:l[8]||(l[8]=t=>m.deleteComments(null))},{default:i(()=>[a(" \u786E \u5B9A ")]),_:1})])]),_:1},8,["visible"])]),_:1})}var Ke=Q(W,[["render",se],["__scopeId","data-v-0a27fcf3"]]);export{Ke as default};
