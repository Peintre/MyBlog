import{i as B}from"./image-conversion.2d06665b.js";import{_ as v}from"./index.ae6b5db7.js";import{o as n,c as j,ag as i,Q as x,R as o,a as p,W as u,X as s,a6 as f,F as w,V as g,S as q,Y as H,b7 as M,b6 as R}from"./@vue.9e9a2d45.js";import"./@babel.1ce85722.js";import"./axios.cdba3bd7.js";import"./form-data.d1f94bc2.js";import"./vue-router.b11bef48.js";import"./vuex.029ab250.js";import"./vuex-persistedstate.fa252374.js";import"./nprogress.8c2c2e00.js";import"./vue-axios.516efde1.js";import"./element-plus.e856da41.js";import"./lodash-es.1d9717e1.js";import"./@vueuse.15af719d.js";import"./@element-plus.b2728cca.js";import"./@popperjs.36402333.js";import"./@ctrl.82a509e0.js";import"./dayjs.68f6f475.js";import"./async-validator.fb49d0f5.js";import"./memoize-one.4ee5c96d.js";import"./escape-html.e5dfadb9.js";import"./normalize-wheel-es.8aeb3683.js";import"./@floating-ui.f14f28ca.js";import"./@kangc.b9a0ef8b.js";import"./vue.a84c3055.js";import"./markdown-it-emoji.952032df.js";import"./@vuepress.3e7afe62.js";import"./markdown-it-container.512a5043.js";import"./highlight.js.6e93349b.js";import"./codemirror.59d98cc1.js";var U={"[\u5FAE\u7B11]":"https://static.talkxj.com/emoji/smile.jpg","[\u7B11]":" https://static.talkxj.com/emoji/dx.jpg","[\u5472\u7259]":"https://static.talkxj.com/emoji/cy.jpg","[OK]":"https://static.talkxj.com/emoji/ok.jpg","[\u661F\u661F\u773C]":"https://static.talkxj.com/emoji/xxy.jpg","[\u54E6\u547C]":"https://static.talkxj.com/emoji/oh.jpg","[\u5ACC\u5F03]":"https://static.talkxj.com/emoji/xq.jpg","[\u559C\u6B22]":"https://static.talkxj.com/emoji/xh.jpg","[\u9178\u4E86]":"https://static.talkxj.com/emoji/sl.jpg","[\u5927\u54ED]":"https://static.talkxj.com/emoji/dq.jpg?","[\u5BB3\u7F9E]":"https://static.talkxj.com/emoji/hx.jpg","[\u65E0\u8BED]":"https://static.talkxj.com/emoji/wy.jpg","[\u7591\u60D1]":"https://static.talkxj.com/emoji/yh.jpg","[\u8C03\u76AE]":"https://static.talkxj.com/emoji/tiaopi.jpg","[\u7B11\u54ED]":"https://static.talkxj.com/emoji/xiaoku.jpg","[\u5978\u7B11]":"https://static.talkxj.com/emoji/jianxiao.jpg","[\u5077\u7B11]":"https://static.talkxj.com/emoji/touxiao.jpg","[\u5927\u7B11]":"https://static.talkxj.com/emoji/daxiao.jpg","[\u9634\u9669]":"https://static.talkxj.com/emoji/yinxian.jpg","[\u6342\u8138]":"https://static.talkxj.com/emoji/wulian.jpg","[\u5446]":"https://static.talkxj.com/emoji/dai.jpg","[\u62A0\u9F3B]":"https://static.talkxj.com/emoji/koubi.jpg","[\u60CA\u559C]":"https://static.talkxj.com/emoji/jingxi.jpg","[\u60CA\u8BB6]":"https://static.talkxj.com/emoji/jingya.jpg","[\u6342\u8138\u54ED]":"https://static.talkxj.com/emoji/wulianku.jpg","[\u5999\u554A]":"https://static.talkxj.com/emoji/miaoa.jpg","[\u72D7\u5934]":"https://static.talkxj.com/emoji/goutou.jpg","[\u6ED1\u7A3D]":"https://static.talkxj.com/emoji/huaji.jpg","[\u5403\u74DC]":"https://static.talkxj.com/emoji/chigua.jpg","[\u6253call]":"https://static.talkxj.com/emoji/dacall.jpg","[\u70B9\u8D5E]":"https://static.talkxj.com/emoji/dianzan.jpg","[\u9F13\u638C]":"https://static.talkxj.com/emoji/guzhang.jpg","[\u5C34\u5C2C]":"https://static.talkxj.com/emoji/ganga.jpg","[\u51B7]":"https://static.talkxj.com/emoji/leng.jpg","[\u7075\u9B42\u51FA\u7A8D]":"https://static.talkxj.com/emoji/linghunchuqiao.jpg","[\u59D4\u5C48]":"https://static.talkxj.com/emoji/weiqu.jpg","[\u50B2\u5A07]":"https://static.talkxj.com/emoji/aojiao.jpg","[\u75BC]":"https://static.talkxj.com/emoji/teng.jpg","[\u5413]":"https://static.talkxj.com/emoji/xia.jpg?","[\u751F\u75C5]":"https://static.talkxj.com/emoji/shengbing.jpg","[\u5410]":"https://static.talkxj.com/emoji/tu.jpg","[\u5618\u58F0]":"https://static.talkxj.com/emoji/xusheng.jpg","[\u6342\u773C]":"https://static.talkxj.com/emoji/wuyan.jpg","[\u601D\u8003]":"https://static.talkxj.com/emoji/sikao.jpg","[\u518D\u89C1]":"https://static.talkxj.com/emoji/zaijian.jpg","[\u7FFB\u767D\u773C]":"https://static.talkxj.com/emoji/fanbaiyan.jpg","[\u54C8\u6B20]":"https://static.talkxj.com/emoji/haqian.jpg","[\u594B\u6597]":"https://static.talkxj.com/emoji/fengdou.jpg","[\u58A8\u955C]":"https://static.talkxj.com/emoji/mojing.jpg","[\u6487\u5634]":"https://static.talkxj.com/emoji/piezui.jpg","[\u96BE\u8FC7]":"https://static.talkxj.com/emoji/nanguo.jpg","[\u6293\u72C2]":"https://static.talkxj.com/emoji/zhuakuang.jpg","[\u751F\u6C14]":"https://static.talkxj.com/emoji/shengqi.jpg","[\u7231\u5FC3]":"https://static.talkxj.com/emoji/aixin.jpg","[\u80DC\u5229]":"https://static.talkxj.com/emoji/shengli.jpg","[\u4FDD\u4F51]":"https://static.talkxj.com/emoji/baoyou.jpg","[\u652F\u6301]":"https://static.talkxj.com/emoji/zhichi.jpg"};const A={props:{modelValue:{type:String,default:""},placeholder:{type:String,default:""}},data(){return{innerText:this.modelValue,range:null,isLocked:!1}},methods:{onInput(){this.$emit("update:modelValue",this.$el.innerHTML)},onBlur(){window.getSelection&&(this.range=window.getSelection().getRangeAt(0))},addText(t){if(window.getSelection){var e=window.getSelection();e.removeAllRanges(),this.range==null&&(this.$refs.editor.focus(),this.range=e.getRangeAt(0)),this.range.deleteContents(),this.range.insertNode(this.range.createContextualFragment(t)),this.range.collapse(!1),e.addRange(this.range),this.$emit("update:modelValue",this.$el.innerHTML)}},clear(){this.$el.innerHTML="",this.$emit("update:modelValue",this.$el.innerHTML)}},watch:{modelValue(t,e){!this.isLocked&&this.$route.params.talkId&&(this.$el.innerHTML=t,this.isLocked=!0)}}},N=["innerHTML","placeholder"];function D(t,e,c,r,h,a){return n(),j("div",{ref:"editor",class:"edit-container",innerHTML:h.innerText,placeholder:c.placeholder,onInput:e[0]||(e[0]=(...m)=>a.onInput&&a.onInput(...m)),onBlur:e[1]||(e[1]=(...m)=>a.onBlur&&a.onBlur(...m))},null,40,N)}var P=v(A,[["render",D],["__scopeId","data-v-44320dce"]]);const F={components:{Editor:P},created(){this.$route.params.talkId&&this.axios.get("/api/talk/getTalk/"+this.$route.params.talkId).then(({data:t})=>{this.talk=t.data,this.talk.imgList&&this.talk.imgList.forEach(e=>{this.uploadList.push({url:e})})})},data:function(){return{emojiList:U,talk:{id:null,content:"",isTop:0,status:1,images:null},statusList:[{status:1,desc:"\u516C\u5F00"},{status:2,desc:"\u79C1\u5BC6"}],uploadList:[]}},methods:{handleCommand(t){this.talk.status=t},addEmoji(t,e){this.$refs.editor.addText("<img src= '"+e+"' width='24'height='24' alt="+t+" style='margin: 0 1px;vertical-align: text-bottom'/>")},handleRemove(t){this.uploadList.forEach((e,c)=>{e.url==t.url&&this.uploadList.splice(c,1)})},upload(t){this.uploadList.push({url:t.data})},beforeUpload(t){return["image/jpeg","image/png","image/gif"].includes(t.type)?new Promise((r,h)=>{t.size/1024<200&&r(t),B.compressAccurately(t,200).then(a=>{r(a)})}):(this.$message.error("\u56FE\u7247\u683C\u5F0F\u53EA\u80FD\u662F JPG/PNG/GIF!"),!1)},saveOrUpdateTalk(){if(this.talk.content.trim()=="")return this.$message.error("\u8BF4\u8BF4\u5185\u5BB9\u4E0D\u80FD\u4E3A\u7A7A"),!1;if(this.uploadList.length>0){var t=[];this.uploadList.forEach(e=>{t.push(e.url)}),this.talk.images=JSON.stringify(t)}this.$route.params.talkId?this.axios.post("/api/talk/updateTalk",this.talk).then(({data:e})=>{e.flag?(this.$router.push({path:"/talk-list"}),this.$notify.success({title:"\u6210\u529F",message:e.message})):this.$notify.error({title:"\u5931\u8D25",message:e.message})}):this.axios.post("/api/talk/addTalk",this.talk).then(({data:e})=>{e.flag?(this.$router.push({path:"/talk-list"}),this.$notify.success({title:"\u6210\u529F",message:e.message})):this.$notify.error({title:"\u5931\u8D25",message:e.message})})}},computed:{dropdownTitle(){var t="";return this.statusList.forEach(e=>{e.status==this.talk.status&&(t=e.desc)}),t}}},y=t=>(M("data-v-31ef0a07"),t=t(),R(),t),O={class:"title"},G={class:"talk-container"},J={class:"operation-wrapper"},K={class:"left-wrapper"},Q=["onClick"],W=["src","title"],X=y(()=>p("i",{class:"iconfont el-icon-mybiaoqing operation-btn"},null,-1)),Y=y(()=>p("i",{class:"iconfont el-icon-mytupian operation-btn"},null,-1)),Z={class:"right-wrapper"},tt={class:"talk-status"};function et(t,e,c,r,h,a){const m=i("Editor"),L=i("el-popover"),k=i("el-upload"),T=i("el-switch"),b=i("ArrowDown"),_=i("el-icon"),$=i("el-dropdown-item"),V=i("el-dropdown-menu"),I=i("el-dropdown"),C=i("el-button"),S=i("Plus"),E=i("el-card");return n(),x(E,{class:"main-card"},{default:o(()=>[p("div",O,u(this.$route.name),1),p("div",G,[s(m,{ref:"editor",class:"editor-wrapper",modelValue:t.talk.content,"onUpdate:modelValue":e[0]||(e[0]=l=>t.talk.content=l),placeholder:"\u8BF4\u70B9\u4EC0\u4E48\u5427"},null,8,["modelValue"]),p("div",J,[p("div",K,[s(L,{placement:"bottom-start",width:"460",trigger:"hover"},{reference:o(()=>[X]),default:o(()=>[(n(!0),j(w,null,f(t.emojiList,(l,d,z)=>(n(),j("span",{class:"emoji-item",key:z,onClick:at=>a.addEmoji(d,l)},[p("img",{src:l,title:d,class:"emoji",width:"24",height:"24"},null,8,W)],8,Q))),128))]),_:1}),s(k,{action:"/api/talk/uploadImages",multiple:"","before-upload":a.beforeUpload,"on-success":a.upload,"show-file-list":!1},{default:o(()=>[Y]),_:1},8,["before-upload","on-success"])]),p("div",Z,[s(T,{style:{"margin-right":"16px"},modelValue:t.talk.isTop,"onUpdate:modelValue":e[1]||(e[1]=l=>t.talk.isTop=l),"inactive-text":"\u7F6E\u9876","active-value":1,"inactive-value":0},null,8,["modelValue"]),s(I,{trigger:"click",onCommand:a.handleCommand,style:{"margin-right":"16px"}},{dropdown:o(()=>[s(V,null,{default:o(()=>[(n(!0),j(w,null,f(t.statusList,(l,d)=>(n(),x($,{key:d,command:l.status},{default:o(()=>[g(u(l.desc),1)]),_:2},1032,["command"]))),128))]),_:1})]),default:o(()=>[p("span",tt,[g(u(a.dropdownTitle)+" ",1),s(_,null,{default:o(()=>[s(b)]),_:1})])]),_:1},8,["onCommand"]),s(C,{type:"primary",size:"default",onClick:a.saveOrUpdateTalk,disabled:t.talk.content==""},{default:o(()=>[g(" \u53D1\u5E03 ")]),_:1},8,["onClick","disabled"])])]),q(s(k,{class:"talk-image-upload",action:"/api/talk/uploadImages","list-type":"picture-card","file-list":t.uploadList,multiple:"","before-upload":a.beforeUpload,"on-success":a.upload,"on-remove":a.handleRemove},{default:o(()=>[s(_,null,{default:o(()=>[s(S)]),_:1})]),_:1},8,["file-list","before-upload","on-success","on-remove"]),[[H,t.uploadList.length>0]])])]),_:1})}var zt=v(F,[["render",et],["__scopeId","data-v-31ef0a07"]]);export{zt as default};
