import{p as F}from"./common.10683f1a.js";import{ag as l,aj as T,o as g,Q as u,R as i,a as o,W as y,L as h,X as t,V as r,a7 as $,S as N,U as _,b7 as Y,b6 as B}from"./@vue.9e9a2d45.js";import{_ as K}from"./index.ae6b5db7.js";import"./dayjs.68f6f475.js";import"./@babel.1ce85722.js";import"./axios.cdba3bd7.js";import"./form-data.d1f94bc2.js";import"./vue-router.b11bef48.js";import"./vuex.029ab250.js";import"./vuex-persistedstate.fa252374.js";import"./nprogress.8c2c2e00.js";import"./vue-axios.516efde1.js";import"./element-plus.e856da41.js";import"./lodash-es.1d9717e1.js";import"./@vueuse.15af719d.js";import"./@element-plus.b2728cca.js";import"./@popperjs.36402333.js";import"./@ctrl.82a509e0.js";import"./async-validator.fb49d0f5.js";import"./memoize-one.4ee5c96d.js";import"./escape-html.e5dfadb9.js";import"./normalize-wheel-es.8aeb3683.js";import"./@floating-ui.f14f28ca.js";import"./@kangc.b9a0ef8b.js";import"./vue.a84c3055.js";import"./markdown-it-emoji.952032df.js";import"./@vuepress.3e7afe62.js";import"./markdown-it-container.512a5043.js";import"./highlight.js.6e93349b.js";import"./codemirror.59d98cc1.js";const j={created(){this.listMessages()},data:function(){return{loading:!0,deleteFlag:!1,messageIdList:[],messageList:[],keywords:null,isReview:null,current:1,size:10,count:0}},computed:{dataFormat(){return function(e){return F(e,"YYYY-MM-DD")}}},methods:{selectionChange(e){this.messageIdList=[],e.forEach(s=>{this.messageIdList.push(s.id)})},searchMessages(){this.current=1,this.listMessages()},sizeChange(e){this.size=e,this.listMessages()},currentChange(e){this.current=e,this.listMessages()},deleteMessage(e){var s={};e!=null?s={data:[e]}:s={data:this.messageIdList},this.axios.delete("/api/admin/messages",s).then(({data:c})=>{c.flag?(this.$notify.success({title:"\u6210\u529F",message:c.message}),this.listMessages()):this.$notify.error({title:"\u5931\u8D25",message:c.message}),this.deleteFlag=!1})},updateMessageReview(e){let s={};e!=null?s.idList=[e]:s.idList=this.messageIdList,s.isReview=1,this.axios.put("/api/admin/messages/review",s).then(({data:c})=>{c.flag?(this.$notify.success({title:"\u6210\u529F",message:c.message}),this.listMessages()):this.$notify.error({title:"\u5931\u8D25",message:c.message})})},changeReview(e){this.isReview=e},listMessages(){this.axios.get("/api/message/getMessages",{params:{current:this.current,size:this.size,keywords:this.keywords,isReview:this.isReview}}).then(({data:e})=>{this.messageList=e.data.recordList,this.count=e.data.count,this.loading=!1})}},watch:{isReview(){this.current=1,this.listMessages()}}},v=e=>(Y("data-v-447e944f"),e=e(),B(),e),U={class:"title"},A={class:"review-menu"},E=v(()=>o("span",null,"\u72B6\u6001",-1)),Q={class:"operation-container"},W={style:{"margin-left":"auto"}},X=["src"],q=v(()=>o("div",{class:"dialog-title-container",slot:"title"},[o("i",{class:"el-icon-warning",style:{color:"#ff9900"}}),r("\u63D0\u793A ")],-1)),G=v(()=>o("div",{style:{"font-size":"1rem"}},"\u662F\u5426\u5220\u9664\u9009\u4E2D\u9879\uFF1F",-1)),H={slot:"footer"};function J(e,s,c,O,P,n){const C=l("Delete"),m=l("el-icon"),p=l("el-button"),k=l("CircleCheck"),f=l("Search"),b=l("el-input"),d=l("el-table-column"),w=l("el-tag"),M=l("Timer"),z=l("el-popconfirm"),R=l("el-table"),L=l("el-pagination"),S=l("el-dialog"),I=l("el-card"),D=T("loading");return g(),u(I,{class:"main-card"},{default:i(()=>[o("div",U,y(this.$route.name),1),o("div",A,[E,o("span",{onClick:s[0]||(s[0]=a=>n.changeReview(null)),class:h(e.isReview==null?"active-review":"review")}," \u5168\u90E8 ",2),o("span",{onClick:s[1]||(s[1]=a=>n.changeReview(1)),class:h(e.isReview==1?"active-review":"review")}," \u6B63\u5E38 ",2),o("span",{onClick:s[2]||(s[2]=a=>n.changeReview(0)),class:h(e.isReview==0?"active-review":"review")}," \u5BA1\u6838\u4E2D ",2)]),o("div",Q,[t(p,{type:"danger",size:"small",disabled:e.messageIdList.length==0,onClick:s[3]||(s[3]=a=>e.deleteFlag=!0)},{default:i(()=>[t(m,null,{default:i(()=>[t(C)]),_:1}),r(" \u6279\u91CF\u5220\u9664 ")]),_:1},8,["disabled"]),t(p,{type:"success",size:"small",disabled:e.messageIdList.length==0,onClick:s[4]||(s[4]=a=>n.updateMessageReview(null))},{default:i(()=>[t(m,null,{default:i(()=>[t(k)]),_:1}),r(" \u6279\u91CF\u901A\u8FC7 ")]),_:1},8,["disabled"]),o("div",W,[t(b,{modelValue:e.keywords,"onUpdate:modelValue":s[5]||(s[5]=a=>e.keywords=a),size:"small",placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u6635\u79F0",style:{width:"200px"},onKeyup:$(n.searchMessages,["enter","native"])},{prefix:i(()=>[t(m,null,{default:i(()=>[t(f)]),_:1})]),_:1},8,["modelValue","onKeyup"]),t(p,{type:"primary",size:"small",style:{"margin-left":"1rem"},onClick:n.searchMessages},{default:i(()=>[t(m,null,{default:i(()=>[t(f)]),_:1}),r("\u641C\u7D22 ")]),_:1},8,["onClick"])])]),N((g(),u(R,{border:"",data:e.messageList,onSelectionChange:n.selectionChange},{default:i(()=>[t(d,{type:"selection",width:"55"}),t(d,{prop:"avatar",label:"\u5934\u50CF",align:"center",width:"150"},{default:i(a=>[o("img",{src:a.row.avatar,width:"40",height:"40"},null,8,X)]),_:1}),t(d,{prop:"nickname",label:"\u7559\u8A00\u4EBA",align:"center",width:"150"}),t(d,{prop:"messageContent",label:"\u7559\u8A00\u5185\u5BB9",align:"center"}),t(d,{prop:"ipAddress",label:"ip\u5730\u5740",align:"center",width:"150"}),t(d,{prop:"ipSource",label:"ip\u6765\u6E90",align:"center",width:"170"}),t(d,{prop:"isReview",label:"\u72B6\u6001",width:"80",align:"center"},{default:i(a=>[a.row.isReview==0?(g(),u(w,{key:0,type:"warning"},{default:i(()=>[r("\u5BA1\u6838\u4E2D")]),_:1})):_("",!0),a.row.isReview==1?(g(),u(w,{key:1,type:"success"},{default:i(()=>[r("\u6B63\u5E38")]),_:1})):_("",!0)]),_:1}),t(d,{prop:"createTime",label:"\u7559\u8A00\u65F6\u95F4",width:"140",align:"center"},{default:i(a=>[t(m,{style:{"margin-right":"5px"}},{default:i(()=>[t(M)]),_:1}),r(" "+y(n.dataFormat(a.row.createTime)),1)]),_:1}),t(d,{label:"\u64CD\u4F5C",width:"160",align:"center"},{default:i(a=>[a.row.isReview==0?(g(),u(p,{key:0,size:"small",type:"success",slot:"reference",onClick:V=>n.updateMessageReview(a.row.id)},{default:i(()=>[r(" \u901A\u8FC7 ")]),_:2},1032,["onClick"])):_("",!0),t(z,{style:{"margin-left":"10px"},title:"\u786E\u5B9A\u5220\u9664\u5417\uFF1F",onConfirm:V=>n.deleteMessage(a.row.id)},{reference:i(()=>[t(p,{size:"small",type:"danger",slot:"reference"},{default:i(()=>[r(" \u5220\u9664 ")]),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data","onSelectionChange"])),[[D,e.loading]]),t(L,{class:"pagination-container",background:"",onSizeChange:n.sizeChange,onCurrentChange:n.currentChange,"current-page":e.current,"page-size":e.size,total:e.count,"page-sizes":[10,20],layout:"total, sizes, prev, pager, next, jumper"},null,8,["onSizeChange","onCurrentChange","current-page","page-size","total"]),t(S,{visible:e.deleteFlag,width:"30%"},{default:i(()=>[q,G,o("div",H,[t(p,{onClick:s[6]||(s[6]=a=>e.deleteFlag=!1)},{default:i(()=>[r("\u53D6 \u6D88")]),_:1}),t(p,{type:"primary",onClick:s[7]||(s[7]=a=>n.deleteMessage(null))},{default:i(()=>[r(" \u786E \u5B9A ")]),_:1})])]),_:1},8,["visible"])]),_:1})}var Se=K(j,[["render",J],["__scopeId","data-v-447e944f"]]);export{Se as default};
